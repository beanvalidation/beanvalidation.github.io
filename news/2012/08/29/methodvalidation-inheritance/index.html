<html>
  <head>
    <meta charset="UTF-8">
    <meta content="IE=Edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>
      Bean Validation - Method validation and inheritance - feedback needed!
    </title>
    <link href="../../../../../stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="../../../../../stylesheets/print.css" media="print" rel="stylesheet" type="text/css">
    <!--[if lt IE 8]>
      <link href="../../../../../stylesheets/ie.css" media="screen, projection" rel="stylesheet" type="text/css">
    <![endif]-->
    <link href="../../../../news.atom" rel="alternate" type="application/atom+xml">
    <script src="//code.jquery.com/jquery-2.1.4.min.js"></script>
    <script src="/javascripts/patternfly.js"></script>
    <script src="/javascripts/bootstrap.js"></script>
  </head>
  <body>
    <header role="banner">
      <nav class="navbar navbar-default navbar-pf" role="navigation">
        <div class="navbar-header">
          <button class="navbar-toggle" data-target=".navbar-collapse-1" data-toggle="collapse" type="button">
            <span class="sr-only">Toggle Navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../../../../.." id="logo" title="Bean Validation">
            Bean Validation
          </a>
        </div>
        <div class="collapse navbar-collapse navbar-collapse-1">
          <ul class="nav navbar-nav navbar-primary navbar-right" id="meny-primary">
            <li class="menu-item menu-item-type-post_type menu-item-object-page">
              <a href="../../../../..">Home</a>
            </li>
            <li class="menu-item menu-item-type-post_type menu-item-object-page">
              <a href="../../../..">News</a>
            </li>
            <li class="menu-item menu-item-type-post_type menu-item-object-page">
              <a href="../../../../../1.1">Specification</a>
            </li>
            <li class="menu-item menu-item-type-post_type menu-item-object-page">
              <a href="../../../../../1.1/tck">TCK</a>
            </li>
            <li class="menu-item menu-item-type-post_type menu-item-object-page">
              <a href="../../../../../1.1/ri">RI</a>
            </li>
            <li class="menu-item menu-item-type-post_type menu-item-object-page">
              <a href="../../../../../1.1/certified">Certified</a>
            </li>
            <li class="menu-item menu-item-type-post_type menu-item-object-page">
              <a href="../../../../../contribute">Contribute</a>
            </li>
            <li class="menu-item menu-item-type-post_type menu-item-object-page">
              <a href="../../../../../licensing">Licensing</a>
            </li>
          </ul>
        </div>
      </nav>
    </header>
    <div class="container" id="overview">
      <div class="clearfix row" id="content">
        <div class="col-sm-9 col-md-9 col-lg-9 clearfix" id="main">
          <article class="post">
            <header>
              <h1 class="title">
                Method validation and inheritance - feedback needed!
              </h1>
              <span class="author">
                by
                <b>Gunnar Morling</b>
              </span>
              <span class="date">
                on 29 Aug 2012
              </span>
              <span class="tags">
                <a class="label label-info" href="/news/tags/feedback-needed/">feedback-needed</a>
              </span>
            </header>
            <div class="body">
              <p>Now that everybody is returning from their summer holidays, also the Bean Validation team
              is getting back to their desks in order to work with full steam towards revision 1.1.</p>
              
              <p>As you know, the largest new feature will be
              <a href="http://beanvalidation.org/1.1/spec/#d0e2147">method validation</a>, that is the validation
              of method parameters and return values using constraint annotations. Bean Validation 1.1
              <a href="http://beanvalidation.org/news/2012/03/13/release-1-1-edr1/">early draft 1</a> lays the
              ground for this, and right now we're tackling some
              <a href="https://hibernate.onjira.com/browse/BVAL-272">advanced questions</a> still open in that area
              (btw. if you haven't yet tried out the
              <a href="http://in.relation.to/Bloggers/FirstAlphaReleaseOfHibernateValidator5">reference implementation</a>
              of ED1, this is the perfect time to do so and give us your feedback).</p>
              
              <h2>The problem</h2>
              
              <p>One question the EG currently is <a href="http://lists.jboss.org/pipermail/beanvalidation-dev/2012-August/000504.html">discussing</a>
              is whether and, if so, how a refinement of method constraints should be allowed in
              sub-types. That is, if a class implements a method of an interface or overrides a method
              from a super class, should the sub-type be allowed to place any additional constraints?</p>
              
              <p>The current draft defines the following rules for such cases (see the
              <a href="http://beanvalidation.org/1.1/spec/#d0e2429">draft document</a> for all the gory details):</p>
              
              <ul>
              <li>No parameter constraints may be specified in addition to those constraints defined on
              the method in the interface or super class.</li>
              <li>Return value constraints may be added in sub-types.</li>
              </ul>
              
              
              <h2>The rationale</h2>
              
              <p>The rationale behind this is the principle of
              <a href="http://en.wikipedia.org/wiki/Liskov_substitution_principle">behavioral sub-typing</a>, which
              demands that wherever a given type <code>T</code> is used, it should be possible to replace <code>T</code> with
              a sub-type <code>S</code> of <code>T</code>. This means that a sub-type must not strengthen a method's
              preconditions (by adding parameter constraints), as this might cause client code working
              correctly against <code>T</code> to fail when working against <code>S</code>. A sub-type may also not weaken a
              method's postconditions. However, a sub-type may strengthen the method's postconditions
              (by adding return value constraints), as client code working against <code>T</code> still will work
              against <code>S</code>.</p>
              
              <h2>Can you show me some code, please?</h2>
              
              <p>To give you an example, the following shows a constraint declaration considered illegal as
              of the current draft, as parameter constraints are added to the <code>placeOrder()</code> method in a
              sub-class of <code>OrderService</code>:</p>
              
              <pre><code>public class OrderService {&#x000A;    void placeOrder(@NotNull String customerCode, @NotNull Item item, int quantity) { ... }&#x000A;}&#x000A;&#x000A;public class SimpleOrderService extends OrderService {&#x000A;&#x000A;    @Override&#x000A;    public void placeOrder(&#x000A;        @Size(min=3, max=20) String customerCode,&#x000A;        Item item,&#x000A;        @Min(1) int quantity) { ... }&#x000A;}&#x000A;</code></pre>
              
              <h2>Alternatives</h2>
              
              <p>While this approach works, follows principles of clean OO design and also
              <a href="http://research.microsoft.com/en-us/projects/contracts/">is employed</a> by other
              <em>Programming by Contract</em> solutions, some voices in the EG expressed doubts whether the
              handling of parameter constraints isn't too restrictive and thus may limit innovation in
              that area. In particular with respect to legacy code, the question was raised whether it
              shouldn't be allowed to add parameter constraints in sub-types.</p>
              
              <p>One example may be a legacy interface, which <em>technically</em> has no constraints (that is, no
              parameter constraints are placed on its methods), but comes with a verbal description of
              preconditions in its documentation. In this case an implementor of that interface might
              wish to implement this contract by placing corresponding constraint annotations on the
              implementation.</p>
              
              <p>An open question in this situation is what should the behavior be if the
              interface is being constrained afterwards?</p>
              
              <h2>Give use your feedback!</h2>
              
              <p>So what do you think, should such a refinement of parameter constraints be allowed or not?
              Possible alternatives:</p>
              
              <ul>
              <li>allow such a refinement by default</li>
              <li>have some sort of switch controlling the behavior (either standardized or provider-specific)</li>
              </ul>
              
              
              <p>As there are pro's and con's of either approach, we'd very interested in user feedback on this.</p>
              
              <p>Let us know what you think by posting a comment directly to this blog, shooting a message
              to the <a href="https://lists.jboss.org/mailman/listinfo/beanvalidation-dev">mailing list</a> or
              participating in this <a href="http://www.doodle.com/qp78u6mqzetuas7p">Doodle vote</a>. Which use cases
              you have encountered come to mind where the possibility to refine parameter constraints
              may help you?</p>
            </div>
            <footer>
              <div id="post-navigation">
                <div class="previous">
                  &laquo;
                  <a href="../../../06/28/hibernate-validator-5-alpha">Hibernate Validator 5 alpha for Bean Validation 1.1 is out</a>
                </div>
                <div class="next">
                  &raquo;
                  <a href="../../31/big-push-on-bean-validation">Big push on Bean Validation 1.1</a>
                </div>
              </div>
              
                          <div id="disqus_thread"></div>
                          <script type="text/javascript">
                          var disqus_shortname = 'beanvalidation';
                          var disqus_url = "http://beanvalidation.org/news/2012/08/29/methodvalidation-inheritance/";
                          var disqus_developer = null;
                          var disqus_identifier = null;
                          (function() {
                            var dsq = document.createElement("script"); dsq.type = "text/javascript"; dsq.async = true;
                            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                            (document.getElementsByTagName("head")[0] || document.getElementsByTagName("body")[0]).appendChild(dsq);
                          })();
                          </script>
                          <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript=beanvalidation">comments powered by Disqus.</a></noscript>
            </footer>
          </article>
        </div>
        <div class="sidebar sidebar-right col-sm-3 col-md-3 col-lg-3" id="sidebar" role="complementary">
          <div id="newsfeed">
            <h2>
              <a href="../news/news.atom"><img alt="atom feed" src="../images/feed-icon-28x28.png"></a>
              <a href="../news/news.atom">
                Latest news
              </a>
            </h2>
            <div id="newsfeed-message">
              Stay up to date, subscribe to the&nbsp;<a href="../news/news.atom">news feed</a>.
            </div>
          </div>
          <a class="news-link" href="/news/2016/07/15/bean-validation-2-0-is-coming/">Bean Validation 2.0 - A new JSR is born!</a>
          <a class="news-link" href="/news/2015/06/18/bean-validation-tck-1-1-4-released/">Bean Validation TCK 1.1.4.Final released</a>
          <a class="news-link" href="/news/2014/06/18/bean-validation-tcks-now-with-support-for-java-se-8/">Bean Validation TCKs now with signature files for Java SE 8</a>
          <a class="news-link" href="/news/2014/05/28/training-materials/">Training materials on Bean Validation 1.1</a>
          <a class="news-link" href="/news/2013/06/04/xml-namespace-and-jcp/">XML namespace and JCP</a>
          <a class="news-link" href="/news/2013/05/02/bean-validation-1-1-is-a-spec/">Bean Validation 1.1 is a spec</a>
          <a class="news-link" href="/news/2013/03/21/bean-validation-1-1-final-approval-ballot/">Bean Validation 1.1 CR3 - Final Approval Ballot</a>
          <a class="news-link" href="/news/2013/02/20/bean-validation-1-1-proposed-final-draft/">Bean Validation 1.1 CR1 - Proposed Final Draft</a>
          <a class="news-link" href="/news/2013/02/15/bean-validation-1-1-beta4/">Bean Validation 1.1 Beta 4 - issue smashing edition</a>
          <a class="news-link" href="/news/2013/02/05/javaspotlight-podcast-on-bean-validation-1-1/">Java Spotlight Podcast on Bean Validation 1.1</a>
          <a class="news-link" href="/news/2013/02/01/bean-validation-1-1-beta3-last-line/">Bean Validation 1.1 Beta 3 - the last line</a>
          <a class="news-link" href="/news/2012/12/18/bean-validation-in-the-press/">Bean Validation in the press</a>
          <a class="news-link" href="/news/2012/12/11/should-getters-be-considered-methods/">Should getters be validated when they are called?</a>
          <a class="news-link" href="/news/2012/11/29/public-review-ballot/">Public review ballot favorable to Bean Validation 1.1</a>
          <a class="news-link" href="/news/2012/11/27/1-1-beta2-is-out/">Bean Validation 1.1 Beta 2 is out</a>
          <a class="news-link" href="/news/2012/10/22/release-1-1-public-review/">Public Review Draft for Bean Validation 1.1</a>
          <a class="news-link" href="/news/2012/09/12/fine-control-over-method-validation/">Fine control over method validation in Bean Validation... or not!</a>
          <a class="news-link" href="/news/2012/08/31/big-push-on-bean-validation/">Big push on Bean Validation 1.1</a>
          <a class="news-link" href="/news/2012/08/29/methodvalidation-inheritance/">Method validation and inheritance - feedback needed!</a>
          <a class="news-link" href="/news/2012/06/28/hibernate-validator-5-alpha/">Hibernate Validator 5 alpha for Bean Validation 1.1 is out</a>
          <a class="news-link" href="/news/2012/06/06/continuous-publication-specification-snapshot/">Continuous publication of the specification snapshot</a>
          <a class="news-link" href="/news/2012/03/28/jcp-release-1-1-edr1/">Bean Validation 1.1 officially reaches the JCP</a>
          <a class="news-link" href="/news/2012/03/16/artifacts-1-1-edr1/">Code artifacts published for Bean Validation 1.1 early draft 1</a>
          <a class="news-link" href="/news/2012/03/13/release-1-1-edr1/">Bean Validation 1.1 early draft 1 is out - time for feedback</a>
          <a class="news-link" href="/news/2012/02/01/method-level-proposal/">Proposal for method validation added</a>
          <a class="news-link" href="/news/2011/10/21/dependency-injection-proposal/">Adding proposal section and first proposal</a>
          <a class="news-link" href="/news/2011/09/16/method-level-validation/">Work on method level validation</a>
          <a class="news-link" href="/news/2011/09/01/spec-repository-out/">The specification repository is released</a>
          <a class="news-link" href="/news/2011/07/23/voted-yes/">Bean Validation has been voted yes!</a>
          <a class="news-link" href="/news/2011/07/22/review-ballot/">Bean Validation in review ballot</a>
          <a class="news-link" href="/news/2011/07/21/Site-is-live/">The website is live!</a>
        </div>
      </div>
    </div>
  </body>
  <footer class="container" id="widget-footer" role="contentinfo">
    <hr>
    <div class="row">
      <div class="widget col-md-12 widget_text">
        Copyright (c) Red Hat, Inc., Emmanuel Bernard
        <a href="http://redhat.com" id="logo-redhat">Red Hat</a>
      </div>
    </div>
  </footer>
</html>
