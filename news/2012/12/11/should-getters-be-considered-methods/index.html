<html>
  <head>
    <meta charset="UTF-8">
    <meta content="IE=Edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>
      Bean Validation - Should getters be validated when they are called?
    </title>
    <link href="../../../../../stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="../../../../../stylesheets/print.css" media="print" rel="stylesheet" type="text/css">
    <!--[if lt IE 8]>
      <link href="../../../../../stylesheets/ie.css" media="screen, projection" rel="stylesheet" type="text/css">
    <![endif]-->
    <link href="../../../../news.atom" rel="alternate" type="application/atom+xml">
    <script src="//code.jquery.com/jquery-2.1.4.min.js"></script>
    <script src="/javascripts/patternfly.js"></script>
    <script src="/javascripts/bootstrap.js"></script>
  </head>
  <body>
    <header role="banner">
      <nav class="navbar navbar-default navbar-pf" role="navigation">
        <div class="navbar-header">
          <button class="navbar-toggle" data-target=".navbar-collapse-1" data-toggle="collapse" type="button">
            <span class="sr-only">Toggle Navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../../../../.." id="logo" title="Bean Validation">
            Bean Validation
          </a>
        </div>
        <div class="collapse navbar-collapse navbar-collapse-1">
          <ul class="nav navbar-nav navbar-primary navbar-right" id="meny-primary">
            <li class="menu-item menu-item-type-post_type menu-item-object-page">
              <a href="../../../..">News</a>
            </li>
            <li class="menu-item menu-item-type-post_type menu-item-object-page">
              <a href="../../../../../specification">Specification</a>
            </li>
            <li class="menu-item menu-item-type-post_type menu-item-object-page">
              <a href="../../../../../tck">TCK</a>
            </li>
            <li class="menu-item menu-item-type-post_type menu-item-object-page">
              <a href="../../../../../1.1/ri">RI</a>
            </li>
            <li class="menu-item menu-item-type-post_type menu-item-object-page">
              <a href="../../../../../1.1/certified">Certified</a>
            </li>
            <li class="menu-item menu-item-type-post_type menu-item-object-page">
              <a href="../../../../../contribute">Contribute</a>
            </li>
            <li class="menu-item menu-item-type-post_type menu-item-object-page">
              <a href="../../../../../licensing">Licensing</a>
            </li>
          </ul>
        </div>
      </nav>
    </header>
    <div class="container" id="overview">
      <div class="clearfix row" id="content">
        <div class="col-sm-9 col-md-9 col-lg-9 clearfix" id="main">
          <article class="post">
            <header>
              <h1 class="title">
                Should getters be validated when they are called?
              </h1>
              <span class="author">
                by
                <b>Emmanuel Bernard</b>
              </span>
              <span class="date">
                on 11 Dec 2012
              </span>
              <span class="tags">
                <a class="label label-info" href="/news/tags/feedback/">feedback</a>
              </span>
            </header>
            <div class="body">
              <p>The expert group is agonizing on a specific issue. We need your
              feedback. Should getters be considered <em>regular</em> methods and thus be validated
              when called?</p>
              
              <h2>The problem</h2>
              
              <p>Existing applications put Bean Validation constraints on properties
              (ie getters). If we enable validations when getters are called, some
              applications might fail and Bean Validation would not be backward
              compatible. Besides, it is unlikely that you want to validate genuine getters
              when they are called. These are state, not operations for the most part.</p>
              
              <p>First off what does it mean to be a getter. A method is a getter if:</p>
              
              <ul>
              <li>its name starts with <code>is</code>, has no parameter and its return type is <code>Boolean</code></li>
              <li>or its name starts with <code>get</code> and has not parameter</li>
              </ul>
              
              
              <p>If in your service (say a CDI bean), you have an action method with
              no parameter and starting with <code>get</code>, and if you have added constraints
              to validate the return value upon method call, we cannot differentiate
              this action method from a genuine getter.</p>
              
              <p>We have several solutions to work around the problem and we would like
              to know which one you prefer.</p>
              
              <h2>Solutions</h2>
              
              <p>We can use a few levers to work around the issue:</p>
              
              <ul>
              <li>ask you to enable method validation explicitly</li>
              <li>offer a coarse or fine grained solution to change the default behavior</li>
              </ul>
              
              
              <h3>Solution 1: enable method validation out of the box</h3>
              
              <p>If method validation is enabled out of the box then the sensible default is
              to exclude getters from method validation.</p>
              
              <p>This approach is friendly out of the box and will work as expected most of
              the time (except for action methods with no parameter, starting with <code>get</code>
              and with constraints on the return value).</p>
              
              <p>The downside of this approach is that in this very specific case where
              an action method is also a getter, method validation would be disabled
              out of the box and a manual intervention would be necessary.</p>
              
              <p>You can change the default approach in two ways:</p>
              
              <h4>Solution 1.a: global flag</h4>
              
              <p>Use a global flag to disable method validation entirely or ask for getters
              to be validated upon call. You would use <code>validation.xml</code> for that:</p>
              
              <pre><code>&lt;method-validation mode="INCLUDE_GETTERS"/&gt;&#x000A;</code></pre>
              
              <p>There is no way to change the behavior for a specific (set of) class.</p>
              
              <h4>Solution 1.b: fine grained flag</h4>
              
              <p>An alternative solution is to change method validation behavior in a
              much more fine-grained approach:</p>
              
              <ul>
              <li>set the default approach globally
              in <code>validation.xml</code></li>
              <li>set or override the setting for a given package (including sub-packages?)
              via <code>@ValidateOnCall</code> as a package annotation (or <code>validation.xml</code>)</li>
              <li>set or override the setting for a given class
              via <code>@ValidateOnCall</code> as a type annotation (or <code>validation.xml</code>)</li>
              <li>set or override the setting for a given method
              via <code>@ValidateOnCall</code> as a method annotation (or <code>validation.xml</code>)</li>
              </ul>
              
              
              <p>A <code>@ValidateOnCall</code> annotation can be overridden in <code>validation.xml</code> like we do for
              constraints declarations.</p>
              
              <pre><code>public class AwesomeService {&#x000A;    // not a getter - validated by default&#x000A;    @NotNull Currency provideMainCurrency(@ISO @NotNull String country) { ... }&#x000A;&#x000A;    // not a getter - validated by default&#x000A;    @NotNull Currency getAlternativeCurrencies(@ISO @NotNull String country) { ... }&#x000A;&#x000A;    // getter - must use @ValidateOnCall to activate&#x000A;    @ValidateOnCall(mode=INCLUDE_GETTERS)&#x000A;    @NotNull getAllCurrencies() { ... }&#x000A;}&#x000A;</code></pre>
              
              <p>Note that, we could put <code>@ValidateOnCall(mode=INCLUDE_GETTERS)</code> on the package
              of service classes</p>
              
              <pre><code>@ValidateOnCall(mode=INCLUDE_GETTERS)&#x000A;package com.acme.gladiator.action;&#x000A;</code></pre>
              
              <p>In this case, <code>getAllCurrencies()</code> does not need to be annotated with <code>@ValidateOnCall</code>.</p>
              
              <h3>Solution 2: disable method validation out of the box</h3>
              
              <p>In this situation, a user wanting to enable method validation needs to both:</p>
              
              <ul>
              <li>add the constraints on methods</li>
              <li>add the flag to enable method validation</li>
              </ul>
              
              
              <p>The method validation flag would both allow it to be enabled and decide if getters
              should be considered.</p>
              
              <p>This approach is the least surprise approach as nothing is happening that you
              have not explicitly asked for. The drawback is that it requires a manual intervention to enable
              method validation in a given archive which is not groovy.</p>
              
              <h4>Solution 2.a: global flag</h4>
              
              <p>For all archives using method validation, a <code>META-INF/validation.xml</code> file must
              be added. The file would contain the explicit setting:</p>
              
              <pre><code>&lt;method-validation mode="INCLUDE_GETTER"/&gt;&#x000A;</code></pre>
              
              <p>There is no way to change the behavior for a specific (set of) classes.</p>
              
              <h4>Solution 2.b: fine grained flag</h4>
              
              <p>As described in the previous section, we could enable method validation at
              the package, class and method level using either a <code>@ValidateOnCall</code> annotation
              or via the <code>validation.xml</code>. In this approach, <code>validation.xml</code> is not mandatory
              to enable method validation provided that you use <code>@ValidateOnCall</code> in your code.</p>
              
              <h2>So what's your favorite?</h2>
              
              <p>My personal favorite is to enable non-getter method validation out of the
              box and offer fine-grained options to override the behavior. That's solution
              1.b. My reasoning is the following:</p>
              
              <ul>
              <li>I want ease of use and method validation enabled by default</li>
              <li>actions methods named like a getter, with no parameter and constraints
              on its return value will be rare - return value constraint are less common
              than parameter methods</li>
              </ul>
              
              
              <p>Some in the expert group do prefer solution 2.a or 2.b.</p>
              
              <p>What's your take? And why do you prefer this approach?</p>
            </div>
            <footer>
              <div id="post-navigation">
                <div class="previous">
                  &laquo;
                  <a href="../../../11/29/public-review-ballot">Public review ballot favorable to Bean Validation 1.1</a>
                </div>
                <div class="next">
                  &raquo;
                  <a href="../../18/bean-validation-in-the-press">Bean Validation in the press</a>
                </div>
              </div>
              
                          <div id="disqus_thread"></div>
                          <script type="text/javascript">
                          var disqus_shortname = 'beanvalidation';
                          var disqus_url = "http://beanvalidation.org/news/2012/12/11/should-getters-be-considered-methods/";
                          var disqus_developer = null;
                          var disqus_identifier = null;
                          (function() {
                            var dsq = document.createElement("script"); dsq.type = "text/javascript"; dsq.async = true;
                            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                            (document.getElementsByTagName("head")[0] || document.getElementsByTagName("body")[0]).appendChild(dsq);
                          })();
                          </script>
                          <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript=beanvalidation">comments powered by Disqus.</a></noscript>
            </footer>
          </article>
        </div>
        <div class="sidebar sidebar-right col-sm-3 col-md-3 col-lg-3" id="sidebar" role="complementary">
          <div id="newsfeed">
            <h2>
              <a href="/news/news.atom"><img alt="atom feed" src="/images/feed-icon-28x28.png"></a>
              <a href="/news/news.atom">
                Latest news
              </a>
            </h2>
            <div id="newsfeed-message">
              Stay up to date, subscribe to the&nbsp;<a href="/news/news.atom">news feed</a>.
            </div>
          </div>
          <a class="news-link" href="/news/2017/02/16/first-alpha-of-bean-validation-2-0-reference-implementation/">First Alpha of Bean Validation 2.0 Reference Implementation Available</a>
          <a class="news-link" href="/news/2017/02/14/bean-validation-2-0-early-draft-released/">Bean Validation 2.0 Early Draft 1 is Out</a>
          <a class="news-link" href="/news/2017/02/07/apache-bval-is-compatible-with-bean-validation-1-1/">Apache BVal certified as Bean Validation 1.1 implementation</a>
          <a class="news-link" href="/news/2017/01/19/bean-validation-2-0-progress-report/">Bean Validation 2.0 Progress Report</a>
          <a class="news-link" href="/news/2016/11/23/survey-constraints-and-parameterized-type/">Survey - Where do you use constraints on parameterized type?</a>
          <a class="news-link" href="/news/2016/09/15/which-constraints-to-add/">Feedback needed - Which constraints should be added?</a>
          <a class="news-link" href="/news/2016/07/15/bean-validation-2-0-is-coming/">Bean Validation 2.0 - A new JSR is born!</a>
          <a class="news-link" href="/news/2015/06/18/bean-validation-tck-1-1-4-released/">Bean Validation TCK 1.1.4.Final released</a>
          <a class="news-link" href="/news/2014/06/18/bean-validation-tcks-now-with-support-for-java-se-8/">Bean Validation TCKs now with signature files for Java SE 8</a>
          <a class="news-link" href="/news/2014/05/28/training-materials/">Training materials on Bean Validation 1.1</a>
          <a class="news-link" href="/news/2013/06/04/xml-namespace-and-jcp/">XML namespace and JCP</a>
          <a class="news-link" href="/news/2013/05/02/bean-validation-1-1-is-a-spec/">Bean Validation 1.1 is a spec</a>
          <a class="news-link" href="/news/2013/03/21/bean-validation-1-1-final-approval-ballot/">Bean Validation 1.1 CR3 - Final Approval Ballot</a>
          <a class="news-link" href="/news/2013/02/20/bean-validation-1-1-proposed-final-draft/">Bean Validation 1.1 CR1 - Proposed Final Draft</a>
          <a class="news-link" href="/news/2013/02/15/bean-validation-1-1-beta4/">Bean Validation 1.1 Beta 4 - issue smashing edition</a>
          <a class="news-link" href="/news/2013/02/05/javaspotlight-podcast-on-bean-validation-1-1/">Java Spotlight Podcast on Bean Validation 1.1</a>
          <a class="news-link" href="/news/2013/02/01/bean-validation-1-1-beta3-last-line/">Bean Validation 1.1 Beta 3 - the last line</a>
          <a class="news-link" href="/news/2012/12/18/bean-validation-in-the-press/">Bean Validation in the press</a>
          <a class="news-link" href="/news/2012/12/11/should-getters-be-considered-methods/">Should getters be validated when they are called?</a>
          <a class="news-link" href="/news/2012/11/29/public-review-ballot/">Public review ballot favorable to Bean Validation 1.1</a>
          <a class="news-link" href="/news/2012/11/27/1-1-beta2-is-out/">Bean Validation 1.1 Beta 2 is out</a>
          <a class="news-link" href="/news/2012/10/22/release-1-1-public-review/">Public Review Draft for Bean Validation 1.1</a>
          <a class="news-link" href="/news/2012/09/12/fine-control-over-method-validation/">Fine control over method validation in Bean Validation... or not!</a>
          <a class="news-link" href="/news/2012/08/31/big-push-on-bean-validation/">Big push on Bean Validation 1.1</a>
          <a class="news-link" href="/news/2012/08/29/methodvalidation-inheritance/">Method validation and inheritance - feedback needed!</a>
          <a class="news-link" href="/news/2012/06/28/hibernate-validator-5-alpha/">Hibernate Validator 5 alpha for Bean Validation 1.1 is out</a>
          <a class="news-link" href="/news/2012/06/06/continuous-publication-specification-snapshot/">Continuous publication of the specification snapshot</a>
          <a class="news-link" href="/news/2012/03/28/jcp-release-1-1-edr1/">Bean Validation 1.1 officially reaches the JCP</a>
          <a class="news-link" href="/news/2012/03/16/artifacts-1-1-edr1/">Code artifacts published for Bean Validation 1.1 early draft 1</a>
          <a class="news-link" href="/news/2012/03/13/release-1-1-edr1/">Bean Validation 1.1 early draft 1 is out - time for feedback</a>
          <a class="news-link" href="/news/2012/02/01/method-level-proposal/">Proposal for method validation added</a>
          <a class="news-link" href="/news/2011/10/21/dependency-injection-proposal/">Adding proposal section and first proposal</a>
          <a class="news-link" href="/news/2011/09/16/method-level-validation/">Work on method level validation</a>
          <a class="news-link" href="/news/2011/09/01/spec-repository-out/">The specification repository is released</a>
          <a class="news-link" href="/news/2011/07/23/voted-yes/">Bean Validation has been voted yes!</a>
          <a class="news-link" href="/news/2011/07/22/review-ballot/">Bean Validation in review ballot</a>
          <a class="news-link" href="/news/2011/07/21/Site-is-live/">The website is live!</a>
        </div>
      </div>
    </div>
  </body>
  <footer class="container" id="widget-footer" role="contentinfo">
    <hr>
    <div class="row">
      <div class="widget col-md-12 widget_text">
        Copyright (c) Red Hat, Inc., Emmanuel Bernard
        <a href="http://redhat.com" id="logo-redhat">Red Hat</a>
      </div>
    </div>
  </footer>
  <script>
   (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
   
  ga('create', 'UA-24703879-1', 'auto');
  ga('send', 'pageview');
  
  </script>
</html>
